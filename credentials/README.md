
# Сredentials 

**Веб-сервис по работе с учетными данными клиентов**

## Функциональность

- Создание учетной записи
- Чтение учетной записи по id
- Поиск учетной записи по полям [фамилия, имя, отчество, телефон, емейл]. Поиск осуществляется только при условии
  указания хотя бы одного поля

## Поля учетной записи клиента

- id
- bank_id (идентификатор клиента в банке)
- фамилия
- имя
- отчество
- дата рождения
- номер паспорта (вместе с серией в формате ХХХХ ХХХХХХ)
- место рождения
- телефон (в формате 7ХХХХХХХХХХ)
- емейл
- адрес регистрации
- адрес проживания

## Легенда

Клиент может быть создан из разных приложений. В зависимости от приложения отличается логика валидации полей при
создании учетной записи. Приложение определяется по обязательному для указания http-заголовку "x-Source".

**Список значений http-заголовка и правила валидации полей**

1. mail — только имя и емейл обязательные
2. mobile — только номер телефона обязательный
3. bank — bank_id, фамилия, имя, отчество, дата рождения, номер паспорта обязательные
4. gosuslugi — все поля кроме емейла и адреса проживания обязательные


**Дополнительно**

- Код приспособлен для появления новых приложений со своими правилами валидации

## Стек

- Java 17, 
- Spring Boot 2.7.17
- Spring Data Jpa
- Postgres 
- Hibernate
- Liquibase
- Maven
- Swagger
- Lombok
- JUnit
- Docker

## Запуск проекта в Docker

1. Прописать url, username и password для базы данных в файле secret.env;
2. Собрать сервис в пакет .jar (например, через вкладку Maven: Maven -> Lifecycle -> application -> package);
3. Выполнить команду в терминале:
```shell
   docker-compose --project-name credentials --file docker-compose.yml up
```

## Локальный запуск без Docker

1. Прописать url, username и password для базы данных в переменных окружения среды разработки;
2. Там же выбрать локальный профиль при необходимости;
3. Подключиться к базе данных в среде разработки.

## Управление

После запуска программы выполните переход по ссылке: [Swagger](http://localhost:8081/swagger-ui/index.html#/)

Тестовые сценарии для Swagger доступны в папке [swaggertests](src/main/resources/swaggertests) 

## Ввод новых приложений

1. Ознакомьтесь с правилами, изложенными в файле [application.yaml](src/main/resources/application.yaml)
2. При тестировании в Swagger, пожалуйста, соблюдайте те же требования к названию нового приложения